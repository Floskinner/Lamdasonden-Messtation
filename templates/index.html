<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Maybach - Lamdawerte</title>

    <link rel="icon" href="../static/images/maybach_logo_icon_145803.ico">

    <link rel="stylesheet" href="../static/css/w3.css">
    <link rel="stylesheet" href="../static/css/my.css">

</head>

<body>

    <!-- Oberer Bereich -->
    <div class="w3-row" style="height: 5%;">
        <div class="w3-cell" style="padding: 5px;">  
            Aufnahme
            <!-- Rounded switch -->
            <label class="switch">
                <input id="recording" type="checkbox">
                <span class="slider round"></span>
            </label>
        </div>
        <div class="w3-cell w3-hide-small">
            <button id="btnHistory" class="w3-button w3-round-large w3-border" onclick="location.href='http://192.168.1.1:3000/d/pyXFX0gRk/lamdawerte?orgId=1';">History</button>
        </div>
    </div>

    <!-- Mittlerer Bereich -->
    <div class="w3-cell-row" style="height: 90%;">
        <!-- Linke Seite / Bank 1 -->
        <div class="w3-cell w3-container w3-cell-middle w3-center w3-mobile">
            <p class="bank">Bank 1</p>
            <p id="lamda1" class="lamda">1,040 &lambda;</p>
            <p id="volt1" class="volt">0,723 V</p>
        </div>

        <!-- Rechte Seite / Bank 2 -->
        <div class="w3-cell w3-container w3-cell-middle w3-center w3-mobile">
            <p class="bank">Bank 2</p>
            <p id="lamda2" class="lamda">1,666 &lambda;</p>
            <p id="volt2" class="volt">0,723 V</p>
        </div>
    </div>

    <!-- Unterer Bereich -->
    <div class="w3-row w3-center w3-border-top" style="height: 3%; ">
        &copy; {{ currentYear }} - 2021 by Florian Glaser
    </div>


</body>

</html>

<script src="../static/javascript/jquery-3.5.1.min.js"></script>
<script src="../static/javascript/socket.io.min.js"></script>

<script type="text/javascript" charset="utf-8">

    var socket = io.connect('http://' + document.domain + ':' + location.port);

    $( "#recording" ).change(function() {
        if($("#recording").prop( "checked" )) {

            // Hide Button wenn aufgenommen wird
            $('#btnHistory').hide("slow");

            socket.emit("recording", {
                 "recording": true
            });
        } else {
            // Show Button wenn aufgenommen stoppt
            $('#btnHistory').show("slow");

            socket.emit("recording", { 
                "recording": false
            });
        }
    });

    socket.on('connect', function () {
        let browserTime = new Date().toISOString()

        socket.emit('connected', {
            data: browserTime
        })

    })

    socket.on('disconnect', function () {
        socket.emit('disconnect', {
            data: 'User Disconnected'
        })

    })

    socket.on('newValues', function (values) {
        // console.log(JSON.stringify(values));

        $('#lamda1').html(values.lamda1.toFixed(3) + " &lambda;");
        $('#lamda2').html(values.lamda2.toFixed(3) + " &lambda;");
        $('#volt1').html(values.voltage1.toFixed(3) + " V");
        $('#volt2').html(values.voltage2.toFixed(3) + " V");

    })
</script>